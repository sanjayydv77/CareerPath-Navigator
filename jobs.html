<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jobs & Internships - CareerPath Navigator</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; position: relative; }
        .back-btn { position: fixed; top: 30px; left: 30px; width: 50px; height: 50px; background: rgba(255, 255, 255, 0.9); border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); transition: all 0.3s ease; z-index: 1000; }
        .back-btn:hover { background: white; transform: scale(1.1); }
        .header { text-align: center; margin-bottom: 30px; margin-top: 60px; }
        .header h1 { color: white; font-size: 2.5em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); }
        .header p { color: rgba(255, 255, 255, 0.9); font-size: 1.2em; margin-bottom: 30px; }
        .toggle-container { display: flex; justify-content: center; margin-bottom: 30px; }
        .toggle-switch { background: rgba(255, 255, 255, 0.2); border-radius: 50px; padding: 5px; display: flex; position: relative; backdrop-filter: blur(10px); }
        .toggle-option { padding: 12px 30px; border: none; background: transparent; color: white; cursor: pointer; border-radius: 45px; transition: all 0.3s ease; font-weight: 600; font-size: 16px; }
        .toggle-option.active { background: white; color: #667eea; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); }
        .search-filters { background: rgba(255, 255, 255, 0.15); border-radius: 15px; padding: 25px; margin-bottom: 30px; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
        .filter-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .search-input, .filter-select { padding: 12px 15px; border: none; border-radius: 8px; background: rgba(255, 255, 255, 0.9); font-size: 14px; transition: all 0.3s ease; }
        .search-input:focus, .filter-select:focus { outline: none; box-shadow: 0 0 10px rgba(255, 255, 255, 0.5); transform: translateY(-2px); }
        .opportunities-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; margin-bottom: 50px; }
        .job-card { background: linear-gradient(145deg, #ffffff, #f0f0f0); border-radius: 15px; padding: 25px; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1); transition: all 0.3s ease; border-left: 5px solid #28a745; position: relative; overflow: hidden; }
        .job-card::before { content: ''; position: absolute; top: 0; right: 0; width: 100px; height: 100px; background: linear-gradient(45deg, #28a745, #20c997); border-radius: 50%; transform: translate(50px, -50px); opacity: 0.1; }
        .job-card:hover { transform: translateY(-5px); box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15); }
        .job-badge { background: linear-gradient(45deg, #28a745, #20c997); color: white; padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; position: absolute; top: 15px; right: 15px; }
        .internship-card { background: linear-gradient(145deg, #fff8e1, #ffecb3); border-radius: 15px; padding: 25px; box-shadow: 0 8px 25px rgba(255, 193, 7, 0.2); transition: all 0.3s ease; border-left: 5px solid #ffc107; position: relative; overflow: hidden; }
        .internship-card::before { content: ''; position: absolute; top: 0; right: 0; width: 100px; height: 100px; background: linear-gradient(45deg, #ffc107, #ff9800); border-radius: 50%; transform: translate(50px, -50px); opacity: 0.1; }
        .internship-card:hover { transform: translateY(-5px); box-shadow: 0 15px 35px rgba(255, 193, 7, 0.3); }
        .internship-badge { background: linear-gradient(45deg, #ffc107, #ff9800); color: white; padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; position: absolute; top: 15px; right: 15px; }
        .opportunity-title { font-size: 1.3em; font-weight: 700; margin-bottom: 10px; color: #333; }
        .company-name { color: #666; font-weight: 600; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }
        .opportunity-details { margin-bottom: 20px; }
        .detail-item { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; font-size: 14px; color: #555; }
        .detail-icon { width: 16px; height: 16px; flex-shrink: 0; }
        .skills-tags { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px; }
        .skill-tag { background: rgba(102, 126, 234, 0.1); color: #667eea; padding: 4px 10px; border-radius: 15px; font-size: 12px; border: 1px solid rgba(102, 126, 234, 0.2); }
        .apply-btn { width: 100%; padding: 12px; background: linear-gradient(45deg, #667eea, #764ba2); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .apply-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4); }
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); backdrop-filter: blur(5px); }
        .modal-content { background: white; margin: 5% auto; padding: 30px; border-radius: 15px; width: 90%; max-width: 600px; max-height: 85vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid #f0f0f0; }
        .modal-title { font-size: 1.5em; color: #333; font-weight: 700; }
        .close-modal { background: none; border: none; font-size: 30px; color: #999; cursor: pointer; transition: color 0.3s ease; }
        .close-modal:hover { color: #667eea; }
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; }
        .form-input, .form-select, .form-textarea { width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; transition: all 0.3s ease; }
        .form-input:focus, .form-select:focus, .form-textarea:focus { outline: none; border-color: #667eea; box-shadow: 0 0 10px rgba(102, 126, 234, 0.2); }
        .form-textarea { resize: vertical; min-height: 100px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .file-upload { border: 2px dashed #d0d0d0; border-radius: 8px; padding: 30px; text-align: center; transition: all 0.3s ease; cursor: pointer; }
        .file-upload:hover { border-color: #667eea; background: rgba(102, 126, 234, 0.05); }
        .file-upload input { display: none; }
        .upload-text { color: #666; margin-top: 10px; }
        .submit-btn { width: 100%; padding: 15px; background: linear-gradient(45deg, #28a745, #20c997); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-top: 20px; }
        .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4); }
        .success-message { display: none; background: linear-gradient(45deg, #28a745, #20c997); color: white; padding: 20px; border-radius: 10px; text-align: center; margin-bottom: 20px; }
        .hidden { display: none !important; }
        .results-count { color: white; text-align: center; margin-bottom: 20px; font-size: 16px; }
        @media (max-width: 768px) { .opportunities-grid { grid-template-columns: 1fr; } .form-row { grid-template-columns: 1fr; } .header h1 { font-size: 2em; } .modal-content { margin: 10% auto; padding: 20px; } }
    </style>
</head>
<body>
    <div class="container">
        <button class="back-btn" onclick="goBack()">‚óÄ</button>
        <div class="header"><h1>Career Opportunities</h1><p>Discover your next career move with top companies</p></div>
        <div class="toggle-container">
            <div class="toggle-switch">
                <button class="toggle-option active" onclick="switchPanel('jobs')">Jobs</button>
                <button class="toggle-option" onclick="switchPanel('internships')">Internships</button>
            </div>
        </div>
        <div class="search-filters">
            <div class="filter-row">
                <input type="text" class="search-input" id="searchInput" placeholder="Search opportunities...">
                <select class="filter-select" id="locationFilter"><option value="">All Locations</option><option value="Mumbai">Mumbai</option><option value="Delhi">Delhi</option><option value="Bangalore">Bangalore</option><option value="Chennai">Chennai</option><option value="Hyderabad">Hyderabad</option><option value="Pune">Pune</option><option value="Indore">Indore</option><option value="Bhopal">Bhopal</option><option value="Remote">Remote</option></select>
                <select class="filter-select" id="categoryFilter"><option value="">All Categories</option><option value="Technology">Technology</option><option value="Marketing">Marketing</option><option value="Design">Design</option><option value="Sales">Sales</option><option value="Finance">Finance</option><option value="HR">Human Resources</option><option value="Operations">Operations</option></select>
                <select class="filter-select" id="experienceFilter"><option value="">Experience Level</option><option value="Fresher">Fresher</option><option value="1-3 years">1-3 years</option><option value="3-5 years">3-5 years</option><option value="5+ years">5+ years</option></select>
            </div>
        </div>
        <div class="results-count" id="resultsCount">Showing all opportunities</div>
        <div class="opportunities-grid" id="opportunitiesGrid"></div>
    </div>

    <div id="applicationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h2 class="modal-title" id="modalTitle">Apply for Position</h2><button class="close-modal" onclick="closeModal()">&times;</button></div>
            <div class="success-message" id="successMessage"><h3>üéâ Application Submitted!</h3><p>We have received your application and added it to your dashboard.</p></div>
            <form id="applicationForm">
                <div class="form-row"><div class="form-group"><label class="form-label">First Name *</label><input type="text" class="form-input" id="firstName" required></div><div class="form-group"><label class="form-label">Last Name *</label><input type="text" class="form-input" id="lastName" required></div></div>
                <div class="form-group"><label class="form-label">Email *</label><input type="email" class="form-input" id="email" required></div>
                <div class="form-row"><div class="form-group"><label class="form-label">Degree *</label><select class="form-select" id="degree" required><option value="">Select Degree</option><option value="B.Tech">B.Tech</option><option value="B.E">B.E</option><option value="MCA">MCA</option><option value="MBA">MBA</option><option value="B.Com">B.Com</option><option value="BCA">BCA</option><option value="M.Tech">M.Tech</option><option value="Other">Other</option></select></div><div class="form-group"><label class="form-label">Stream/Specialization *</label><input type="text" class="form-input" id="stream" placeholder="e.g., Computer Science" required></div></div>
                <div class="form-group"><label class="form-label">Upload Resume * (PDF)</label><div class="file-upload" onclick="document.getElementById('resume').click()"><div style="font-size: 40px; color: #667eea;">üìÑ</div><div class="upload-text">Click to upload your resume</div><input type="file" id="resume" accept=".pdf" required></div></div>
                <div class="form-group"><label class="form-label" id="question1Label">Question 1</label><textarea class="form-textarea" id="answer1" required></textarea></div>
                <div class="form-group"><label class="form-label" id="question2Label">Question 2</label><textarea class="form-textarea" id="answer2" required></textarea></div>
                <button type="submit" class="submit-btn">Submit Application</button>
            </form>
        </div>
    </div>

   <script>
    const token = localStorage.getItem('token');
    let currentPanel = 'jobs';
    let allOpportunities = [];
    let currentOpportunity = null;

    // --- FULL DATASET (Restored) ---
    const jobsData = [
        { title: "Software Engineer", company: "Google India", location: "Bangalore", type: "Full-time", experience: "1-3 years", salary: "‚Çπ18-25 LPA", category: "Technology", skills: ["JavaScript", "Python", "React", "Node.js"], questions: ["Why Google?", "Describe a challenging project."] },
        { title: "Product Manager", company: "Microsoft", location: "Hyderabad", type: "Full-time", experience: "3-5 years", salary: "‚Çπ20-25 LPA", category: "Technology", skills: ["Product Strategy", "Market Research"], questions: ["How would you improve Outlook?", "What makes a good PM?"] },
        { title: "Data Scientist", company: "Amazon", location: "Chennai", type: "Full-time", experience: "1-3 years", salary: "‚Çπ15-22 LPA", category: "Technology", skills: ["Python", "SQL", "ML"], questions: ["Describe a time you used data to make a decision.", "Favorite ML algorithm?"] },
        { title: "Senior Business Analyst", company: "Deloitte", location: "Mumbai", type: "Full-time", experience: "3-5 years", salary: "‚Çπ14-18 LPA", category: "Operations", skills: ["SQL", "Business Analysis"], questions: ["How do you handle stakeholder requirements?", "Describe a process you optimized."] },
        { title: "Full-Stack Developer", company: "TCS", location: "Indore", type: "Full-time", experience: "1-3 years", salary: "‚Çπ6-9 LPA", category: "Technology", skills: ["Java", "Spring Boot", "Angular"], questions: ["Why TCS?", "Explain full-stack architecture."] },
        { title: "UX Design Intern", company: "Flipkart", location: "Bangalore", type: "3 months", experience: "Fresher", stipend: "‚Çπ5,000/month", category: "Design", skills: ["Figma", "User Research"], questions: ["How do you approach user-centered design?", "Show us a design challenge."] },
        { title: "Marketing Intern", company: "Zomato", location: "Delhi", type: "3 months", experience: "Fresher", stipend: "‚Çπ5,000/month", category: "Marketing", skills: ["Social Media", "Content"], questions: ["How would you promote a new restaurant?", "Social media trends?"] },
        { title: "Frontend Development Intern", company: "Paytm", location: "Noida", type: "4 months", experience: "Fresher", stipend: "‚Çπ7,000/month", category: "Technology", skills: ["React", "JS"], questions: ["Favorite frontend tech?", "Responsive design?"] },
        { title: "Business Development Intern", company: "BYJU'S", location: "Pune", type: "2 months", experience: "Fresher", stipend: "‚Çπ25,000/month", category: "Sales", skills: ["Sales", "Communication"], questions: ["How do you approach clients?", "Motivation in sales?"] },
        { title: "Financial Analysis Intern", company: "HDFC Bank", location: "Mumbai", type: "6 months", experience: "Fresher", stipend: "‚Çπ21,000/month", category: "Finance", skills: ["Excel", "Financial Modeling"], questions: ["Interest in financial analysis?", "Data interpretation?"] },
        { title: "HR Intern", company: "TCS", location: "Chennai", type: "3 months", experience: "Fresher", stipend: "‚Çπ30,000/month", category: "HR", skills: ["Recruitment", "Employee Engagement"], questions: ["Why HR?", "Handling confidential info?"] },
        { title: "Cloud Computing Intern", company: "Infosys", location: "Bangalore", type: "4 months", experience: "Fresher", stipend: "‚Çπ25,000/month", category: "Technology", skills: ["AWS", "Cloud Architecture"], questions: ["Understanding of cloud?", "Learning new tech?"] },
        { title: "Content Writing Intern", company: "Swiggy", location: "Bangalore", type: "2 months", experience: "Fresher", stipend: "‚Çπ20,000/month", category: "Marketing", skills: ["Writing", "SEO"], questions: ["Engaging food content?", "Writing process?"] },
        { title: "Quality Assurance Intern", company: "Wipro", location: "Pune", type: "3 months", experience: "Fresher", stipend: "‚Çπ3,000/month", category: "Technology", skills: ["Manual Testing", "Test Cases"], questions: ["Understanding of testing?", "Attention to detail?"] },
        { title: "Business Analyst Intern", company: "Capgemini", location: "Mumbai", type: "5 months", experience: "Fresher", stipend: "‚Çπ9,000/month", category: "Operations", skills: ["Requirements Analysis", "Documentation"], questions: ["Gathering requirements?", "Analytical tools?"] },
        { title: "Mobile Development Intern", company: "PhonePe", location: "Bangalore", type: "4 months", experience: "Fresher", stipend: "‚Çπ15,000/month", category: "Technology", skills: ["Android", "iOS"], questions: ["Mobile platforms?", "Mobile UI/UX?"] },
        { title: "Graphic Design Intern", company: "Myntra", location: "Bangalore", type: "3 months", experience: "Fresher", stipend: "‚Çπ25,000/month", category: "Design", skills: ["Photoshop", "Illustrator"], questions: ["Design portfolio?", "Fashion brand design?"] },
        { title: "Operations Intern", company: "Ola", location: "Bangalore", type: "3 months", experience: "Fresher", stipend: "‚Çπ15,000/month", category: "Operations", skills: ["Operations Analysis", "Data Analysis"], questions: ["Improving operations?", "Operations management interest?"] },
        { title: "Software Engineering Intern", company: "Accenture", location: "Indore", type: "6 months", experience: "Fresher", stipend: "‚Çπ25,000/month", category: "Technology", skills: ["Java", "Spring Boot"], questions: ["Programming languages?", "Debugging approach?"] },
        { title: "Digital Marketing Intern", company: "Hindustan Unilever", location: "Mumbai", type: "4 months", experience: "Fresher", stipend: "‚Çπ4,000/month", category: "Marketing", skills: ["Social Media Marketing", "Content Creation"], questions: ["Marketing consumer products?", "Digital marketing trends?"] },
        { title: "IT Support Intern", company: "IBM India", location: "Bangalore", type: "3 months", experience: "Fresher", stipend: "‚Çπ30,000/month", category: "Technology", skills: ["Technical Support", "Troubleshooting"], questions: ["Technical problem-solving?", "Computer systems experience?"] },
        { title: "Sales Intern", company: "Salesforce", location: "Hyderabad", type: "2 months", experience: "Fresher", stipend: "‚Çπ35,000/month", category: "Sales", skills: ["Sales Techniques", "CRM"], questions: ["Interest in sales?", "Handling rejection?"] },
        { title: "Research Intern", company: "IIT Bombay", location: "Mumbai", type: "6 months", experience: "Fresher", stipend: "‚Çπ15,000/month", category: "Technology", skills: ["Research Methods", "Data Analysis"], questions: ["Research areas?", "Academic research approach?"] },
        { title: "Cybersecurity Intern", company: "Quick Heal", location: "Pune", type: "4 months", experience: "Fresher", stipend: "‚Çπ23,000/month", category: "Technology", skills: ["Network Security", "Ethical Hacking"], questions: ["Interest in cybersecurity?", "Staying updated?"] },
        { title: "AI/ML Intern", company: "NVIDIA", location: "Bangalore", type: "5 months", experience: "Fresher", stipend: "‚Çπ11,000/month", category: "Technology", skills: ["Machine Learning", "Deep Learning"], questions: ["AI/ML projects?", "Model training?"] },
        { title: "Video Editing Intern", company: "YouTube India", location: "Mumbai", type: "3 months", experience: "Fresher", stipend: "‚Çπ3,000/month", category: "Design", skills: ["Video Editing", "Premiere Pro"], questions: ["Video editing work?", "Engaging content?"] },
        { title: "Supply Chain Intern", company: "Amazon", location: "Chennai", type: "4 months", experience: "Fresher", stipend: "‚Çπ22,000/month", category: "Operations", skills: ["Supply Chain Management", "Logistics"], questions: ["Interest in supply chain?", "Optimizing delivery?"] },
        { title: "Social Media Intern", company: "Netflix India", location: "Mumbai", type: "3 months", experience: "Fresher", stipend: "‚Çπ20,000/month", category: "Marketing", skills: ["Social Media Management", "Content Creation"], questions: ["Promoting content?", "Social platforms?"] },
        { title: "Game Development Intern", company: "Dream11", location: "Mumbai", type: "4 months", experience: "Fresher", stipend: "‚Çπ9,000/month", category: "Technology", skills: ["Unity", "C#"], questions: ["Games developed?", "Game mechanics?"] },
        { title: "E-commerce Intern", company: "Shopify", location: "Bangalore", type: "3 months", experience: "Fresher", stipend: "‚Çπ5,000/month", category: "Technology", skills: ["E-commerce Platforms", "Web Development"], questions: ["Improving shopping experience?", "E-commerce trends?"] },
        { title: "Investment Banking Intern", company: "Goldman Sachs", location: "Mumbai", type: "2 months", experience: "Fresher", stipend: "‚Çπ8,000/month", category: "Finance", skills: ["Financial Analysis", "Investment Research"], questions: ["Why investment banking?", "Analyzing opportunities?"] },
        { title: "Public Relations Intern", company: "Ogilvy", location: "Delhi", type: "3 months", experience: "Fresher", stipend: "‚Çπ10,000/month", category: "Marketing", skills: ["PR Strategy", "Media Relations"], questions: ["Crisis communication?", "Effective PR?"] },
        { title: "Legal Intern", company: "Khaitan & Co", location: "Mumbai", type: "6 months", experience: "Fresher", stipend: "‚Çπ7,000/month", category: "Legal", skills: ["Legal Research", "Documentation"], questions: ["Area of law?", "Legal research approach?"] },
        { title: "HR Operations Intern (Remote)", company: "Upwork", location: "Remote", type: "6 months", experience: "Fresher", stipend: "‚Çπ12,000/month", category: "HR", skills: ["HR Operations", "Onboarding"], questions: ["Remote HR?", "Staying organized?"] },
        { title: "Digital Marketing Intern", company: "Local Agency", location: "Bhopal", type: "3 months", experience: "Fresher", stipend: "‚Çπ15,000/month", category: "Marketing", skills: ["Social Media", "SEO Basics"], questions: ["Social media campaigns?", "Interest in marketing?"] },
        { title: "Marketing Manager", company: "Hindustan Unilever", location: "Mumbai", type: "Full-time", experience: "3-5 years", salary: "‚Çπ12-16 LPA", category: "Marketing", skills: ["Brand Management", "Digital Marketing"], questions: ["Successful campaign?", "Thoughts on brand?"] },
        { title: "DevOps Engineer", company: "Oracle", location: "Bangalore", type: "Full-time", experience: "1-3 years", salary: "‚Çπ10-14 LPA", category: "Technology", skills: ["AWS", "Docker"], questions: ["CI/CD pipeline?", "IaC experience?"] },
        { title: "HR Business Partner", company: "Infosys", location: "Pune", type: "Full-time", experience: "3-5 years", salary: "‚Çπ8-12 LPA", category: "HR", skills: ["Employee Relations", "HR Strategy"], questions: ["Employee conflicts?", "Role of HRBP?"] },
        { title: "Investment Banking Analyst", company: "Goldman Sachs", location: "Bangalore", type: "Full-time", experience: "1-3 years", salary: "‚Çπ22-30 LPA", category: "Finance", skills: ["Financial Modeling", "Excel"], questions: ["Why investment banking?", "Pitch a stock."] },
        { title: "Sales Executive", company: "Salesforce", location: "Mumbai", type: "Full-time", experience: "1-3 years", salary: "‚Çπ9-14 LPA", category: "Sales", skills: ["CRM", "Negotiation"], questions: ["Handling rejection?", "Sell me this pen."] },
        { title: "Backend Engineer", company: "Zomato", location: "Delhi", type: "Full-time", experience: "1-3 years", salary: "‚Çπ14-20 LPA", category: "Technology", skills: ["Python", "Django"], questions: ["System design?", "Scaling experience?"] },
        { title: "UI/UX Designer", company: "Flipkart", location: "Bangalore", type: "Full-time", experience: "1-3 years", salary: "‚Çπ12-18 LPA", category: "Design", skills: ["Figma", "User Research"], questions: ["Portfolio?", "Design process?"] },
        { title: "Management Consultant", company: "BCG", location: "Delhi", type: "Full-time", experience: "3-5 years", salary: "‚Çπ25-35 LPA", category: "Operations", skills: ["Problem Solving", "Strategy"], questions: ["Case study?", "Why consulting?"] },
        { title: "Data Engineer", company: "Paytm", location: "Noida", type: "Full-time", experience: "1-3 years", salary: "‚Çπ13-17 LPA", category: "Technology", skills: ["Spark", "ETL"], questions: ["ETL pipeline?", "Data lake vs warehouse?"] },
        { title: "Digital Marketer", company: "Myntra", location: "Bangalore", type: "Full-time", experience: "1-3 years", salary: "‚Çπ7-10 LPA", category: "Marketing", skills: ["SEO", "SEM"], questions: ["Increasing traffic?", "SEO project?"] },
        { title: "Financial Analyst", company: "HDFC Bank", location: "Mumbai", type: "Full-time", experience: "1-3 years", salary: "‚Çπ6-9 LPA", category: "Finance", skills: ["Excel", "Financial Modeling"], questions: ["Balance sheet analysis?", "Market thoughts?"] },
        { title: "QA Engineer", company: "Wipro", location: "Pune", type: "Full-time", experience: "1-3 years", salary: "‚Çπ5-8 LPA", category: "Technology", skills: ["Selenium", "Manual Testing"], questions: ["Bug reporting?", "Test cases?"] },
        { title: "Operations Manager", company: "Ola", location: "Bangalore", type: "Full-time", experience: "3-5 years", salary: "‚Çπ10-15 LPA", category: "Operations", skills: ["Process Improvement", "Logistics"], questions: ["Driver efficiency?", "Operational challenge?"] },
        { title: "Java Developer", company: "Accenture", location: "Indore", type: "Full-time", experience: "1-3 years", salary: "‚Çπ5-8 LPA", category: "Technology", skills: ["Java", "Spring Boot"], questions: ["REST APIs?", "Java 8 features?"] },
        { title: "Graphic Designer", company: "Swiggy", location: "Bangalore", type: "Full-time", experience: "1-3 years", salary: "‚Çπ6-9 LPA", category: "Design", skills: ["Photoshop", "Illustrator"], questions: ["Portfolio?", "Good design?"] },
        { title: "Business Development Manager", company: "BYJU'S", location: "Pune", type: "Full-time", experience: "1-3 years", salary: "‚Çπ7-12 LPA", category: "Sales", skills: ["Sales", "Communication"], questions: ["Cold calling?", "Motivation?"] },
        { title: "Cloud Architect", company: "IBM India", location: "Bangalore", type: "Full-time", experience: "5+ years", salary: "‚Çπ25-35 LPA", category: "Technology", skills: ["AWS", "Azure"], questions: ["Multi-cloud strategy?", "AWS vs Azure?"] },
        { title: "Legal Counsel", company: "Khaitan & Co", location: "Mumbai", type: "Full-time", experience: "3-5 years", salary: "‚Çπ18-24 LPA", category: "Legal", skills: ["Corporate Law", "Contract Review"], questions: ["Complex contract?", "Why corporate law?"] },
        { title: "Game Developer", company: "Dream11", location: "Mumbai", type: "Full-time", experience: "1-3 years", salary: "‚Çπ10-15 LPA", category: "Technology", skills: ["Unity", "C#"], questions: ["Games built?", "Game mechanics?"] },
        { title: "Content Strategist", company: "Netflix India", location: "Mumbai", type: "Full-time", experience: "3-5 years", salary: "‚Çπ15-20 LPA", category: "Marketing", skills: ["Content Strategy", "SEO"], questions: ["Marketing a new show?", "Content trends?"] },
        { title: "Cybersecurity Analyst", company: "Quick Heal", location: "Pune", type: "Full-time", experience: "1-3 years", salary: "‚Çπ7-11 LPA", category: "Technology", skills: ["Network Security", "Ethical Hacking"], questions: ["Security threats?", "Risk assessment?"] },
        { title: "AI/ML Engineer", company: "NVIDIA", location: "Bangalore", type: "Full-time", experience: "3-5 years", salary: "‚Çπ24-32 LPA", category: "Technology", skills: ["Machine Learning", "Deep Learning"], questions: ["ML model built?", "AI vs ML?"] },
        { title: "E-commerce Manager", company: "Shopify", location: "Bangalore", type: "Full-time", experience: "3-5 years", salary: "‚Çπ16-20 LPA", category: "Technology", skills: ["E-commerce", "Web Development"], questions: ["Merchant experience?", "E-commerce metrics?"] },
        { title: "PR Manager", company: "Ogilvy", location: "Delhi", type: "Full-time", experience: "3-5 years", salary: "‚Çπ9-13 LPA", category: "Marketing", skills: ["PR Strategy", "Media Relations"], questions: ["Brand crisis?", "PR campaign?"] },
        { title: "Mobile Developer (Android)", company: "PhonePe", location: "Bangalore", type: "Full-time", experience: "1-3 years", salary: "‚Çπ14-19 LPA", category: "Technology", skills: ["Android", "Kotlin"], questions: ["Kotlin experience?", "App performance?"] },
        { title: "Software Developer", company: "Persistent Systems", location: "Bhopal", type: "Full-time", experience: "1-3 years", salary: "‚Çπ6-9 LPA", category: "Technology", skills: ["Java", "Spring"], questions: ["Why Persistent?", "Complex Java concept?"] },
        { title: "Data Analyst (Remote)", company: "TCS", location: "Remote", type: "Full-time", experience: "1-3 years", salary: "‚Çπ7-10 LPA", category: "Technology", skills: ["SQL", "Python"], questions: ["Insight from data?", "Remote work experience?"] }
    ];

    function initializePage() {
        allOpportunities = jobsData; 
        filterOpportunities(); 
        setupEventListeners();
    }

    function switchPanel(panel) {
        currentPanel = panel;
        document.querySelectorAll('.toggle-option').forEach(btn => btn.classList.remove('active'));
        if (event && event.target) event.target.classList.add('active');
        filterOpportunities();
    }

    function displayOpportunities(opportunities) {
        const grid = document.getElementById('opportunitiesGrid');
        const resultsCount = document.getElementById('resultsCount');
        resultsCount.textContent = `Showing ${opportunities.length} ${currentPanel}`;
        
        if (opportunities.length === 0) {
            grid.innerHTML = '<div class="no-results" style="color:white; text-align:center; padding:50px;"><h3>No results found</h3></div>';
            return;
        }

        grid.innerHTML = opportunities.map(opp => {
            const isInternship = opp.type.toLowerCase().includes('month');
            const cardClass = isInternship ? 'internship-card' : 'job-card';
            const badgeClass = isInternship ? 'internship-badge' : 'job-badge';
            const pay = opp.salary || opp.stipend;
            
            return `
                <div class="${cardClass}">
                    <div class="${badgeClass}">${opp.type}</div>
                    <h3 class="opportunity-title">${opp.title}</h3>
                    <div class="company-name"><span>üè¢</span> ${opp.company}</div>
                    <div class="opportunity-details">
                        <div class="detail-item"><span>üìç</span> ${opp.location}</div>
                        <div class="detail-item"><span>üíº</span> ${opp.experience}</div>
                        <div class="detail-item"><span>üí∞</span> ${pay}</div>
                    </div>
                    <div class="skills-tags">${opp.skills.map(s => `<span class="skill-tag">${s}</span>`).join('')}</div>
                    <button class="apply-btn" onclick="openApplicationModal('${opp.title}', '${opp.company}', ${JSON.stringify(opp.questions).replace(/"/g, '&quot;')})">Apply Now</button>
                </div>
            `;
        }).join('');
    }

    function filterOpportunities() {
        const search = document.getElementById('searchInput').value.toLowerCase();
        const loc = document.getElementById('locationFilter').value;
        const cat = document.getElementById('categoryFilter').value;
        const exp = document.getElementById('experienceFilter').value;
        
        const filtered = allOpportunities.filter(opp => {
            const isInternship = opp.type.toLowerCase().includes('month');
            if (currentPanel === 'jobs' && isInternship) return false;
            if (currentPanel === 'internships' && !isInternship) return false;

            return (!search || opp.title.toLowerCase().includes(search) || opp.company.toLowerCase().includes(search)) &&
                   (!loc || opp.location === loc) &&
                   (!cat || opp.category === cat) &&
                   (!exp || opp.experience === exp);
        });
        displayOpportunities(filtered);
    }

    function setupEventListeners() {
        ['searchInput', 'locationFilter', 'categoryFilter', 'experienceFilter'].forEach(id => {
            document.getElementById(id).addEventListener('input', filterOpportunities);
        });
    }

    function openApplicationModal(title, company, questions) {
        // --- üîê AUTH CHECK ---
        if (!token) {
            alert("Please log in to apply for jobs.");
            window.location.href = "index.html";
            return;
        }
        document.getElementById('modalTitle').textContent = `Apply for ${title} at ${company}`;
        document.getElementById('question1Label').textContent = questions[0];
        document.getElementById('question2Label').textContent = questions[1];
        document.getElementById('applicationForm').reset();
        document.getElementById('successMessage').style.display = 'none';
        document.getElementById('applicationForm').style.display = 'block';
        document.getElementById('applicationModal').style.display = 'block';
        currentOpportunity = { title, company };
    }

    function closeModal() {
        document.getElementById('applicationModal').style.display = 'none';
    }

    function goBack() {
        window.location.href = "index.html";
    }

    // --- ‚≠ê NEW: Submit Application to Backend ---
    document.getElementById('applicationForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const btn = document.querySelector('.submit-btn');
        btn.innerText = "Submitting...";
        btn.disabled = true;

        try {
            // Save the job title to the user's dashboard via API
            const response = await fetch('http://future-fit-backend-fcmi.onrender.com/api/data/apply-job', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'x-auth-token': token
                },
                body: JSON.stringify({ 
                    jobTitle: `${currentOpportunity.title} at ${currentOpportunity.company}` 
                })
            });

            if (response.ok) {
                document.getElementById('applicationForm').style.display = 'none';
                document.getElementById('successMessage').style.display = 'block';
                setTimeout(closeModal, 3000);
            } else {
                alert("Failed to save application. Please try again.");
            }
        } catch (error) {
            console.error(error);
            alert("Network error.");
        } finally {
            btn.innerText = "Submit Application";
            btn.disabled = false;
        }
    });

    document.getElementById('resume').addEventListener('change', function(e) {
        if (e.target.files[0]) {
            e.target.parentElement.querySelector('.upload-text').textContent = `Selected: ${e.target.files[0].name}`;
            e.target.parentElement.querySelector('.upload-text').style.color = '#28a745';
        }
    });

    window.onclick = (e) => { if (e.target == document.getElementById('applicationModal')) closeModal(); };
    document.addEventListener('DOMContentLoaded', initializePage);
   </script>
</body>
</html>